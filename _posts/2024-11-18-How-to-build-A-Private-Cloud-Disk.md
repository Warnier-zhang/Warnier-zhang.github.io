---
layout: post
title: 如何搭建一个私有云盘
---

最近，装机必备App——**Resilio Sync**无法正常使用，一直在警告`No tracker connection available.`。刚开始，以为是家里宽带DNS被劫持污染，折腾了半天仍无法解决，后来，突然想到Resilio Sync曾被封杀过，恍然大悟。

可能有人没听说过**Resilio Sync**，但是，应该没有人不知道**网盘**。常见的，国外有**iCloud**、**Dropbox**，国内有**百度网盘**、**夸克网盘**等等，上述网盘都是**公有**云，虽然免费，但是可能会限制**存储容量**、**下载速度**等等。此外，公有云都有一个**中心化**的**中继服务器**（**Relay Server**），用户先在某台设备上把文件上传到中继服务器，再由中继服务器把这个文件同步到用户的其他设备。既然文件都保存在中继服务器，就存在隐私遭泄漏的风险。

上述网盘的种种缺点，正是Resilio Sync的优势所在。**Resilio Sync**曾用名BitTorrent Sync，是一款由BitTorrent开发的**P2P文件同步工具**，支持Windows、Mac、Linux、Android、iOS等平台，是搭建个人私有云盘的不二之选。**开箱即用**，仅需要在不同设备上安装Resilio Sync客户端，文件都保存在用户自己的设备上，因此没有存储容量的限制。

现在，回到文章开头遇到的问题：`No tracker connection available.`，即Resilio Sync 无法获取**跟踪程序服务器**（**Tracker Server**）列表。

理论上，基于**P2P分布式技术**，Resilio Sync不需要**中继服务器**（**Relay Server**）、甚至不需要互联网，只需要设备处在同一个局域网下，即可在多台设备之间互相同步和共享文件。

实际上，在默认情况下，Resilio Sync使用**跟踪程序服务器**来注册和发现设备信息；当两台设备不在同一个局域网下时（例如：手机使用移动5G网络，和家庭局域网内的PC无法直接连接。），Resilio Sync使用**中继服务器**来转发数据。

![默认配置](..\images\2024\11\18\默认配置.png)

> 注：笔者过去也没有注意到这一点，没准不小心把隐私泄漏出去了。

当**跟踪程序服务器**、**中继服务器**不可用时，就轮到Resilio Sync背后的**P2P**大显身手了：

> **在同一个局域网下**，可通过勾选使用**预定义主机**，实现多台设备之间**直接连接**。

如下图：

![预定义主机](..\images\2024\11\18\预定义主机.png)

添加某台设备的IP地址和端口，Resilio Sync客户端运行的端口，

- 桌面端

  可通过“设置->高级”查看。

  ![端口（桌面端）](..\images\2024\11\18\端口（桌面端）.png)

- 手机端

  可通过“设置->网络”查看。若手机端默认端口是0，则需要先自行绑定一个端口号。

  ![端口（手机端）](..\images\2024\11\18\端口（手机端）.jpg)

之后，Resilio Sync就能恢复正常了。
